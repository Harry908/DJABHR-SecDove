@startuml
title Client Sequence: Contacts + Conversations Load

actor User
participant "ContactsContext" as CC
participant "ConversationsContext" as CvC
participant "APIClient" as API
participant "CryptoUtils" as CU

== Load Contacts ==
User -> CC: loadContacts()
CC -> API: GET /contacts
API --> CC: { contacts[] }
CC -> User: state.contacts updated

== Load Conversations ==
User -> CvC: loadConversations()
CvC -> API: GET /conversations
API --> CvC: { conversations[] }
loop per conversation
  CvC -> CU: decryptContentKey(encrypted_content_key, privateKey)
  CU --> CvC: contentKey
  CvC -> cache: store { keyNumber, key }
end
CvC -> User: state.conversations updated

@enduml

